<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cubicador de Construcci√≥n - CONSTRUCTORA PRO</title>
    <!-- CSS MODULAR -->
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/header.css">
    <link rel="stylesheet" href="css/toolbar.css">
    <link rel="stylesheet" href="css/workspace.css">
    <link rel="stylesheet" href="css/panel.css">
    <link rel="stylesheet" href="css/modals.css">
    <!-- M√ìDULOS -->
    <link rel="stylesheet" href="muro-hormigon/muro-hormigon.css">
    <link rel="stylesheet" href="muro-albanileria/muro-albanileria.css">
    <link rel="stylesheet" href="radier/radier.css">
    <link rel="stylesheet" href="hormigon/hormigon-styles.css">
    <link rel="stylesheet" href="muros-tabiqueria/tabique.css">
    <link rel="stylesheet" href="muros-estructurales/muro-estructural.css">
    <link rel="stylesheet" href="informe-cubicacion/informe-cubicacion.css">
    <link rel="stylesheet" href="cubicacion-cubierta/cubierta.css">
    <link rel="stylesheet" href="planos-system/plano-styles.css">
    <!-- VISTA 3D -->
    <link rel="stylesheet" href="vista-3d/vista-3d.css">
    <link rel="stylesheet" href="layer-manager/layer-manager.css">
    <!-- SISTEMA ORTHO -->
    <link rel="stylesheet" href="ortho-system/ortho-system.css">
    <!-- SIMULADOR TERREMOTO -->
    <link rel="stylesheet" href="simulador-temblor/earthquake.css">
    <!-- SISTEMA DE VANOS -->
    <link rel="stylesheet" href="vanos-system/vanos_styles.css">
</head>
<body>
    <!-- HEADER PRINCIPAL -->
    <div class="main-header">
        <div class="header-left">
            <div class="logo">
                <div class="logo-icon">üèóÔ∏è</div>
                <div class="logo-text">
                    <div class="logo-title">TRUKILLO</div>
                    <div class="logo-subtitle">SISTEMA DE CUBICACI√ìN</div>
                </div>
            </div>
            <button class="btn-header btn-primary" onclick="cargarPlano()">
                üìÅ CARGAR PLANO
            </button>
            <button class="btn-header btn-secondary" onclick="toggleVista3D()">
                üëÅÔ∏è Vista 3D
            </button>
        </div>
        
        <div class="header-center">
            <div class="project-info">
                <input type="text" id="projectName" placeholder="Nombre del Proyecto" class="input-project">
                <input type="text" id="projectCode" placeholder="C√≥digo" class="input-code">
            </div>
        </div>
        
        <div class="header-right">
            <button class="btn-header" style="background: #e74c3c;" onclick="abrirCubicacion()">
                üìä CUADRO CUBICACI√ìN
            </button>
            
            <button class="btn-header" style="background: #3498db;" onclick="abrirPresupuesto()">
                üí∞ PRESUPUESTO
            </button>
            
            <button class="btn-header" style="background: #f39c12;" onclick="abrirEspecificaciones()">
                üìã ESPECIFICACIONES
            </button>
            
            <button class="btn-header btn-success" onclick="exportarResultados()">
                üíæ EXPORTAR
            </button>
        </div>
    </div>
    
    <!-- BARRA DE HERRAMIENTAS -->
    <div class="toolbar">
        <!-- PRIMERA FILA -->
        <div class="toolbar-row">
            <div class="toolbar-section">
                <span class="toolbar-label">üß± MUROS:</span>
                <button class="btn-tool" onclick="selectTool('muro-hormigon')" title="Muro de hormig√≥n">
                    üß± Hormig√≥n
                </button>
                <button class="btn-tool" onclick="selectTool('muro-albanileria')" title="Muro de alba√±iler√≠a">
                    üß± Alba√±iler√≠a
                </button>
                <button class="btn-tool" onclick="selectTool('tabique')" title="Tabique">
                    üìè Tabique
                </button>
                <button class="btn-tool" onclick="selectTool('muro-estructural')" title="Muro Estructural">
                    üèóÔ∏è Estructural
                </button>
            </div>
            
            <div class="toolbar-section">
                <span class="toolbar-label">üî≤ RADIER:</span>
                <button class="btn-tool" onclick="selectTool('radier')" title="Radier">
                    ‚¨õ Radier
                </button>
                <button class="btn-tool" onclick="selectTool('fundacion')" title="Fundaci√≥n">
                    üèóÔ∏è Fundaci√≥n
                </button>
                <button class="btn-tool" onclick="selectTool('sobrecimiento')" title="Sobrecimiento">
                    üìê Sobrecimiento
                </button>
            </div>
            
            <div class="toolbar-section">
                <span class="toolbar-label">üè† TECHO:</span>
                <button class="btn-tool" onclick="selectTool('estructura-techo')" title="Estructura de techo">
                    üî∫ Estructura
                </button>
                <button class="btn-tool" onclick="selectTool('cubierta')" title="Cubierta">
                    üìÑ Cubierta
                </button>
                <button class="btn-tool" onclick="selectTool('aislacion')" title="Aislaci√≥n">
                    üßä Aislaci√≥n
                </button>
            </div>
            
            <div class="toolbar-section">
                <span class="toolbar-label">ü™µ MADERA:</span>
                <button class="btn-tool" onclick="selectTool('viga')" title="Viga">
                    ‚ûñ Viga
                </button>
                <button class="btn-tool" onclick="selectTool('pilar')" title="Pilar">
                    ‚¨ú Pilar
                </button>
                <button class="btn-tool" onclick="selectTool('marcos')" title="Marcos">
                    üö™ Marcos
                </button>
            </div>
            
            <div class="toolbar-section">
                <span class="toolbar-label">üèóÔ∏è HORMIG√ìN:</span>
                <button class="btn-tool" onclick="selectTool('volumen-hormigon')" title="Volumen de hormig√≥n">
                    üì¶ Volumen
                </button>
                <button class="btn-tool" onclick="selectTool('enfierradura')" title="Enfierradura">
                    üî© Enfierradura
                </button>
                <button class="btn-tool" onclick="selectTool('moldaje')" title="Moldaje">
                    üìã Moldaje
                </button>
            </div>
        </div>
        
        <!-- SEGUNDA FILA - ACCIONES (CON BOT√ìN ORTHO) -->
        <div class="toolbar-row">
            <div class="toolbar-section section-acciones">
                <span class="toolbar-label">‚öôÔ∏è ACCIONES:</span>
                <button class="btn-tool" onclick="medirDistancia()" style="background: #9b59b6;">
                    üìè MEDIR
                </button>
                <button class="btn-tool" onclick="calcularArea()" style="background: #16a085;">
                    üìê √ÅREA
                </button>
                <button class="btn-tool" onclick="calcularVolumen()" style="background: #27ae60;">
                    üì¶ VOLUMEN
                </button>
                <!-- EL BOT√ìN ORTHO SE INSERTAR√Å AQU√ç AUTOM√ÅTICAMENTE -->
                <button class="btn-tool btn-danger" onclick="limpiarTodo()">
                    üóëÔ∏è LIMPIAR
                </button>
            </div>
        </div>
    </div>    
    
    <!-- √ÅREA DE TRABAJO -->
    <div class="main-container">
        <div class="work-area">
            <div class="canvas-title">SISTEMA INTELIGENTE DE CUBICACI√ìN DE OBRA</div>
            <div class="canvas-wrapper">
                <div class="canvas-placeholder">
                    <div class="placeholder-content">
                        <div class="placeholder-icon">üìê</div>
                        <h2>Carga un plano para comenzar</h2>
                        <p>Formatos soportados: PDF, JPG, PNG, SVG</p>
                        <button class="btn-upload" onclick="cargarPlano()">
                            üìÅ CARGAR PLANO
                        </button>
                    </div>
                </div>
                <canvas id="mainCanvas" style="display: none;"></canvas>
            </div>
        </div>
        
        <div class="right-panel">
            <div class="panel-header">
                <h3>üìã PAR√ÅMETROS DE CUBICACI√ìN</h3>
                <p>Configuraci√≥n est√°ndar</p>
            </div>
            <div class="panel-content">
                <div class="info-card">
                    <h4>üß± MUROS</h4>
                    <ul>
                        <li>Hormig√≥n H20: 0.15m - 0.20m</li>
                        <li>Alba√±iler√≠a: 0.14m - 0.29m</li>
                        <li>Tabique: 0.10m - 0.15m</li>
                    </ul>
                </div>
                
                <div class="info-card">
                    <h4>üî≤ RADIER Y LOSAS</h4>
                    <ul>
                        <li>Radier std: 0.10m - 0.15m</li>
                        <li>Losa: 0.15m - 0.20m</li>
                        <li>Fundaci√≥n: 0.40m - 0.60m</li>
                    </ul>
                </div>
                
                <div class="info-card">
                    <h4>üè† TECHUMBRE</h4>
                    <ul>
                        <li>Cerchas: 2x4" - 2x6"</li>
                        <li>Cubierta: Teja/Zinc</li>
                        <li>Pendiente: 25% - 40%</li>
                    </ul>
                </div>
                
                <div class="info-card">
                    <h4>ü™µ MADERA</h4>
                    <ul>
                        <li>Pino: Estructural</li>
                        <li>Roble: Terminaciones</li>
                        <li>Medidas: 2x3" a 4x8"</li>
                    </ul>
                </div>
                
                <div class="info-card">
                    <h4>üèóÔ∏è HORMIG√ìN</h4>
                    <ul>
                        <li>H20: Muros/Losas</li>
                        <li>H25: Pilares</li>
                        <li>H30: Fundaciones</li>
                        <li>Enfierradura A63-42H</li>
                    </ul>
                </div>
                
                <div class="info-card" style="margin-top: 20px; background: #e8f5e9;">
                    <h4>‚å®Ô∏è ATAJOS</h4>
                    <ul style="font-size: 11px;">
                        <li><strong>M</strong>: Medir</li>
                        <li><strong>A</strong>: √Årea</li>
                        <li><strong>V</strong>: Volumen</li>
                        <li><strong>F8</strong>: ORTHO üî≤</li>
                        <li><strong>Ctrl+Z</strong>: Deshacer</li>
                        <li><strong>Del</strong>: Eliminar</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <input type="file" id="fileInput" accept=".pdf,.jpg,.jpeg,.png,.svg" style="display: none;">
    
    <div class="status-bar">
        <span id="status">‚úì Listo para cubicar</span>
        <span id="coordenadas"></span>
        <span id="escala">Escala: 1:100</span>
    </div>

    <!-- MODAL CUADRO DE CUBICACI√ìN -->
    <div class="modal" id="modalCubicacion">
        <div class="modal-window modal-large">
            <div class="modal-header">
                <div class="modal-title">üìä CUADRO DE CUBICACI√ìN</div>
                <button class="btn-close" onclick="cerrarModal('modalCubicacion')">‚úï</button>
            </div>
            <div class="modal-content">
                <div class="cubicacion-container">
                    <table class="tabla-cubicacion">
                        <thead>
                            <tr>
                                <th>PARTIDA</th>
                                <th>DESCRIPCI√ìN</th>
                                <th>UNIDAD</th>
                                <th>CANTIDAD</th>
                                <th>OBSERVACIONES</th>
                            </tr>
                        </thead>
                        <tbody id="tablaCubicacionBody">
                            <tr>
                                <td>1.0</td>
                                <td>OBRA GRUESA</td>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                            </tr>
                            <tr>
                                <td>1.1</td>
                                <td>Excavaci√≥n</td>
                                <td>m¬≥</td>
                                <td>0.00</td>
                                <td>Pendiente medici√≥n</td>
                            </tr>
                            <tr>
                                <td>1.2</td>
                                <td>Hormig√≥n H20</td>
                                <td>m¬≥</td>
                                <td>0.00</td>
                                <td>Pendiente medici√≥n</td>
                            </tr>
                            <tr>
                                <td>1.3</td>
                                <td>Enfierradura A63-42H</td>
                                <td>kg</td>
                                <td>0.00</td>
                                <td>Pendiente medici√≥n</td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="btn-primary" onclick="exportarCubicacion()">üì• Exportar Excel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ============================================
         SISTEMA ORTHO - CARGA PRIORITARIA
         ============================================ -->
    <script src="ortho-system/ortho-state.js"></script>
    <script src="ortho-system/ortho-calculator.js"></script>
    <script src="ortho-system/ortho-visual.js"></script>
    <script src="ortho-system/ortho-ui.js"></script>
    <script src="ortho-system/ortho-integration.js"></script>
    <script src="ortho-system/ortho-init.js"></script>
    <!-- INTERCEPTOR AUTOM√ÅTICO - NO REQUIERE MODIFICAR HERRAMIENTAS -->
    <script src="ortho-system/ortho-integration-fix.js"></script>

    <!-- M√ìDULO CANVAS GLOBAL -->
    <script src="js/canvas-global.js"></script>
    
    <!-- ============================================
         SISTEMA DE VANOS - CARGA ANTES DE MUROS
         ============================================ -->
    <script src="vanos-system/vanos_state.js"></script>
    <script src="vanos-system/vanos_placement.js"></script>
    <script src="vanos-system/vanos_draw_2d.js"></script>
    <script src="vanos-system/vanos_draw_3d.js"></script>
    <script src="vanos-system/vanos_events.js"></script>
    
    <!-- ============================================
         M√ìDULO MURO HORMIG√ìN - VERSI√ìN ACTUALIZADA
         ============================================ -->
    <script src="muro-hormigon/muro-hormigon-state.js"></script>
    <script src="muro-hormigon/muro-hormigon-utils.js"></script>
    <script src="muro-hormigon/muro-hormigon-draw.js"></script>
    <script src="muro-hormigon/muro-hormigon-events.js"></script>
    <script src="muro-hormigon/muro-hormigon-modal.js"></script>
    <script src="muro-hormigon/muro-hormigon-init.js"></script>
    
    <!-- INTEGRACI√ìN VANOS CON HORMIG√ìN -->
    <script src="vanos-system/vanos_integration.js"></script>
    <script src="vanos-system/vanos_init.js"></script>
    
    <!-- M√ìDULO MURO ALBA√ëILER√çA -->
    <script src="muro-albanileria/muro-albanileria-state.js"></script>
    <script src="muro-albanileria/muro-albanileria-utils.js"></script>
    <script src="muro-albanileria/muro-albanileria-draw.js"></script>
    <script src="muro-albanileria/muro-albanileria-events.js"></script>
    <script src="muro-albanileria/muro-albanileria-modal.js"></script>
    <script src="muro-albanileria/muro-albanileria-init.js"></script>

    <!-- M√ìDULO TABIQUER√çA -->
    <script src="muros-tabiqueria/tabique-state.js"></script>
    <script src="muros-tabiqueria/tabique-utils.js"></script>
    <script src="muros-tabiqueria/tabique-draw.js"></script>
    <script src="muros-tabiqueria/tabique-events.js"></script>
    <script src="muros-tabiqueria/tabique-modal.js"></script>
    <script src="muros-tabiqueria/tabique-init.js"></script>
    
    <!-- M√ìDULO RADIER -->
    <script src="radier/radier-state.js"></script>
    <script src="radier/radier-utils.js"></script>
    <script src="radier/radier-draw.js"></script>
    <script src="radier/radier-events.js"></script>
    <script src="radier/radier-modal.js"></script>
    <script src="radier/radier-init.js"></script>

    <!-- M√ìDULO MUROS ESTRUCTURALES -->
    <script src="muros-estructurales/muro-estructural-state.js"></script>
    <script src="muros-estructurales/muro-estructural-utils.js"></script>
    <script src="muros-estructurales/muro-estructural-draw.js"></script>
    <script src="muros-estructurales/muro-estructural-events.js"></script>
    <script src="muros-estructurales/muro-estructural-modal.js"></script>
    <script src="muros-estructurales/muro-estructural-init.js"></script>

    <!-- M√ìDULO INFORME DE CUBICACI√ìN -->
    <script src="informe-cubicacion/informe-cubicacion-state.js"></script>
    <script src="informe-cubicacion/informe-cubicacion-generator.js"></script>
    <script src="informe-cubicacion/informe-cubicacion-modal.js"></script>
    <script src="informe-cubicacion/informe-cubicacion-export.js"></script>
    <script src="informe-cubicacion/informe-cubicacion-init.js"></script>
       
    <!-- M√ìDULO HORMIG√ìN -->
    <script src="hormigon/hormigon-calculator.js"></script>
    <script src="hormigon/hormigon-handler.js"></script>
    
    <!-- SCRIPT PRINCIPAL -->    
    <script src="js/canvas-global.js"></script>    
    <script src="js/main.js"></script>
    <script src="js/zoom-pan.js"></script>

    <!-- M√ìDULO CUBIERTAS -->
    <script src="cubicacion-cubierta/cubierta-state.js"></script>
    <script src="cubicacion-cubierta/cubierta-utils.js"></script>
    <script src="cubicacion-cubierta/cubierta-draw.js"></script>
    <script src="cubicacion-cubierta/cubierta-events.js"></script>
    <script src="cubicacion-cubierta/cubierta-modal.js"></script>
    <script src="cubicacion-cubierta/cubierta-init.js"></script>

    <!-- SISTEMA DE GESTI√ìN DE CAPAS -->    
    <script src="layer-manager/layer-manager-state.js"></script>
    <script src="layer-manager/layer-manager-ui.js"></script>
    <script src="layer-manager/layer-manager-controller.js"></script>
    <script src="layer-manager/layer-manager-integration.js"></script>
    <script src="layer-manager/layer-manager-init.js"></script>

    <!-- SISTEMA MULTI-PLANO -->    
    <script src="planos-system/plano-instance.js"></script>
    <script src="planos-system/plano-state.js"></script>
    <script src="planos-system/plano-manager-cleanup.js"></script>
    <script src="planos-system/plano-manager-state.js"></script>
    <script src="planos-system/plano-manager-export.js"></script>
    <script src="planos-system/plano-manager-helpers.js"></script>
    <script src="planos-system/plano-manager-core.js"></script>
    <script src="planos-system/plano-thumbnails-ui.js"></script>
    <script src="planos-system/plano-integration.js"></script>

    <!-- VISTA 3D - THREE.JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="vista-3d/vista-3d-state.js"></script>
    <script src="vista-3d/vista-3d-scene.js"></script>
    <script src="vista-3d/vista-3d-builder.js"></script>
    <script src="vista-3d/vista-3d-controls.js"></script>
    <script src="vista-3d/vista-3d-modal.js"></script>
    <script src="vista-3d/vista-3d-init.js"></script>

    <!-- SIMULADOR TERREMOTO -->
    <script src="simulador-temblor/earthquake-config.js"></script>
    <script src="simulador-temblor/earthquake-physics.js"></script>
    <script src="simulador-temblor/earthquake-waves-advanced.js"></script>
    <script src="simulador-temblor/earthquake-effects.js"></script>
    <script src="simulador-temblor/earthquake-visual-effects.js"></script>
    <script src="simulador-temblor/earthquake-structural-fx.js"></script>
    <!-- SISTEMAS DE COLAPSO -->
    <script src="simulador-temblor/earthquake-physics-engine.js"></script>
    <script src="simulador-temblor/earthquake-fracture.js"></script>
    <script src="simulador-temblor/earthquake-deformation.js"></script>
    <script src="simulador-temblor/earthquake-collapse.js"></script>
    <!-- CONTROLADOR Y UI -->
    <script src="simulador-temblor/earthquake-controller.js"></script>
    <script src="simulador-temblor/earthquake-ui.js"></script>
    <script src="simulador-temblor/earthquake-init.js"></script>

</body>
</html>