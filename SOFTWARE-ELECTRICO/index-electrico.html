<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editor de Planos El√©ctricos Domiciliarios - ELEKTRA</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="workspace.css">
    <link rel="stylesheet" href="layout-fix.css">
    
    <!-- ESTILOS DE VI√ëETA EL√âCTRICA -->
    <link rel="stylesheet" href="vi√±eta-electrica/vineta-styles.css">
    
    <!-- ESTILOS DEL BUSCADOR -->
    <link rel="stylesheet" href="buscador-electrico/styles.css">
    
    <!-- ESTILOS DEL TABLERO MODAL -->
    <link rel="stylesheet" href="tablero-modal.css">
    
    <!-- ESTILOS DEL SELECTOR DE NIVEL -->
    <link rel="stylesheet" href="level-selector.css">
    
    <!-- ESTILOS DE ELECTRODOM√âSTICOS -->
    <link rel="stylesheet" href="electrodomesticos-styles.css">
    <link rel="stylesheet" href="isometrico-electrico/isometrico-styles.css">    
    
    <!-- ESTILOS DEL ASISTENTE VIRTUAL -->
    <link rel="stylesheet" href="asistente-virtual/asistente.css">       
    
    <!-- ‚ú® NUEVOS ESTILOS DE MODALES - MEMORIA Y EETT ‚ú® -->
    <link rel="stylesheet" href="memoria-electrica/modal-styles.css">
    <link rel="stylesheet" href="especificaciones-tecnicas/modal-styles.css">
    
    <!-- SISTEMA DE PLANOS M√öLTIPLES -->
    <link rel="stylesheet" href="sistema-planos-electricos/electrico-plano-styles.css">
    
    <!-- üìù SISTEMA DE TEXTO PERSONALIZADO -->
    <link rel="stylesheet" href="sistema-texto-plano/texto-styles.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link rel="stylesheet" href="exportar-pdf/exportador-styles.css">
    
</head>
<body>
    <!-- HEADER PRINCIPAL -->
    <div class="main-header">
        <div class="header-left">
            <div class="logo">
                <div>‚ö° ‚ö° ‚ö°</div>
                <div>TRUKILLO</div>
                <div>DISE√ëO EL√âCTRICO</div>                
            </div>
            <button class="btn-header btn-primary" onclick="cargarPlano()">
                üìÅ CARGAR PDF/IMAGEN
            </button>
            <button class="btn-header btn-secondary" id="modeToggle" onclick="toggleMode()">
                üñ±Ô∏è Modo: Edici√≥n
            </button>
        </div>
        
        <div class="header-center">
            <div class="format-selector">
                <span class="format-label">Formato:</span>
                <button class="format-btn active" onclick="changeFormat('A1')" id="btnA1">A1</button>
                <button class="format-btn" onclick="changeFormat('A0')" id="btnA0">A0</button>
            </div>
        </div>
        
        <div class="header-right">
            <button class="btn-header" style="background: #e74c3c;" onclick="abrirTablero()">
                ‚ö° TABLERO EL√âCTRICO
            </button>

            <button class="btn-header" style="background: #3498db;" onclick="abrirUnifilar()">
                üìä ESQUEMA UNIFILAR
            </button>
            
            <button class="btn-header" style="background: #f39c12;" onclick="abrirCuadroCargas()">
                üìã CUADRO DE CARGAS
            </button>
                                   
            <!-- BOT√ìN SIMBOLOG√çA INTEGRABLE AL PLANO -->
            <button class="btn-header" style="background: #9b59b6;" onclick="abrirSimbologiaElectrica()">
                üìä SIMBOLOG√çA EL√âCTRICA
            </button>
            
            <!-- ‚ú® BOT√ìN MEMORIA - AHORA CON MODAL INTEGRADO ‚ú® -->
            <button class="btn-header" style="background: #1abc9c;" onclick="abrirMemoriaCalculo()">
                üìÑ MEMORIA DE C√ÅLCULO
            </button>

            <!-- BOT√ìN VI√ëETA EL√âCTRICA -->
            <button class="btn-header" style="background: #27ae60;" onclick="abrirVineta()">
                üìù VI√ëETA EL√âCTRICA
            </button>

            <button class="btn-header" style="background: #8e44ad;" onclick="abrirIsometrico()">
                üèóÔ∏è ISOM√âTRICO 3D
            </button>
            
            <!-- üìù BOT√ìN TEXTO PERSONALIZADO -->
            <button class="btn-header" style="background: #667eea;" onclick="abrirSistemaTexto()">
                üìù TEXTO PERSONALIZADO
            </button>
            
            <button class="btn-header btn-success" onclick="mostrarModalExportacionPDF()">
                üíæ EXPORTAR PLANO
            </button>
            
            <!-- ‚ú® BOT√ìN EETT - AHORA CON MODAL INTEGRADO ‚ú® -->
            <button class="btn-header" style="background: #d35400;" onclick="abrirEspecificaciones()">
                üìã ESPECIFICACIONES T√âCNICAS
            </button>
        </div>
    </div>
    
    <!-- BARRA DE HERRAMIENTAS -->
    <div class="toolbar">
        <div class="toolbar-section">
            <span class="toolbar-label">ESCALA:</span>
            <button class="btn-tool btn-scale active" onclick="selectScale('1:50')" data-scale="50">1:50</button>
            <button class="btn-tool btn-scale" onclick="selectScale('1:75')" data-scale="75">1:75</button>
            <button class="btn-tool btn-scale" onclick="selectScale('1:100')" data-scale="100">1:100</button>
            <button class="btn-tool btn-scale" onclick="selectScale('1:125')" data-scale="125">1:125</button>
            <button class="btn-tool btn-scale" onclick="selectScale('1:150')" data-scale="150">1:150</button>
        </div>
        
        <div class="toolbar-section section-alimentacion">
            <span class="toolbar-label">ALIMENTACI√ìN:</span>            
            <button class="btn-tool" onclick="selectTool('empalme')" title="Punto de empalme">üîå Empalme</button>
            <button class="btn-tool" onclick="selectTool('medidor')" title="Medidor el√©ctrico">üìä Medidor</button>
            <button class="btn-tool" onclick="selectTool('tablero')" title="Tablero el√©ctrico">‚ö° Tablero</button>
        </div>
        
        <div class="toolbar-section section-iluminacion">
            <span class="toolbar-label">ILUMINACI√ìN:</span>
            <button class="btn-tool" onclick="selectTool('luminaria-cielo')" title="Luminaria de techo">üí° Luminaria Cielo</button>
            <button class="btn-tool" onclick="selectTool('aplique')" title="Aplique mural">üîÜ Aplique Mural</button>
            <button class="btn-tool" onclick="selectTool('luminaria-exterior')" title="Luminaria exterior">üåü Exterior</button>
            <button class="btn-tool" onclick="selectTool('luz-simple')" title="Punto luz + interruptor simple">üí° Luz Simple</button>
            <button class="btn-tool" onclick="selectTool('luz-doble')" title="Punto luz + interruptor doble">üí° Luz Doble</button>
            <button class="btn-tool" onclick="selectTool('conmutado')" title="Sistema conmutado escalera">üîÄ Conmutado</button>
        </div>
        
        <div class="toolbar-section section-enchufes">
            <span class="toolbar-label">ENCHUFES:</span>
            <button class="btn-tool" onclick="selectTool('enchufe-simple')" title="Enchufe simple 10A">üîå Simple 10A</button>
            <button class="btn-tool" onclick="selectTool('enchufe-doble')" title="Enchufe doble">üîå Doble</button>
            <button class="btn-tool" onclick="selectTool('enchufe-especial')" title="Enchufe especial (refrigerador)">üîå Especial</button>
            <button class="btn-tool" onclick="selectTool('enchufe-exterior')" title="Enchufe exterior IP">üîå Exterior IP</button>
        </div>
        
        <div class="toolbar-section section-interruptores">
            <span class="toolbar-label">INTERRUPTORES:</span>
            <button class="btn-tool" onclick="selectTool('int-simple')" title="Interruptor simple">üîò Simple</button>
            <button class="btn-tool" onclick="selectTool('int-doble')" title="Interruptor doble">üîò Doble</button>
            <button class="btn-tool" onclick="selectTool('conmutador')" title="Conmutador">üîÄ Conmutador</button>
            <button class="btn-tool" onclick="selectTool('pulsador')" title="Pulsador">‚è∫Ô∏è Pulsador</button>
        </div>
        
        <div class="toolbar-section section-electrodomesticos">
            <span class="toolbar-label">ELECTRODOM√âSTICOS:</span>
            <button class="btn-tool" onclick="selectTool('lavadora')" title="Lavadora">üß∫ Lavadora</button>
            <button class="btn-tool" onclick="selectTool('secadora')" title="Secadora">üåÄ Secadora</button>
            <button class="btn-tool" onclick="selectTool('refrigerador')" title="Refrigerador">üßä Refrigerador</button>
            <button class="btn-tool" onclick="selectTool('microondas')" title="Microondas">üçΩÔ∏è Microondas</button>
            <button class="btn-tool" onclick="selectTool('horno')" title="Horno el√©ctrico">üî• Horno</button>
            <button class="btn-tool" onclick="selectTool('cocina')" title="Cocina el√©ctrica">üç≥ Cocina</button>
            <button class="btn-tool" onclick="selectTool('calefon')" title="Calef√≥n/Terma">üöø Calef√≥n</button>
        </div>
        
        <div class="toolbar-section section-canalizacion">
            <span class="toolbar-label">CANALIZACI√ìN:</span>
            <button class="btn-tool" onclick="selectTool('ducto-pvc')" title="Ducto PVC">üìè Ducto PVC</button>
            <button class="btn-tool" onclick="selectTool('ducto-emt')" title="Ducto EMT met√°lico">üìè Ducto EMT</button>
            <button class="btn-tool" onclick="selectTool('conductor')" title="L√≠nea de conductor">‚ûñ Conductor</button>
            <button class="btn-tool" onclick="selectTool('caja-derivacion')" title="Caja de derivaci√≥n">üì¶ Caja Deriv.</button>
        </div>
        
        <div class="toolbar-section section-tierra">
            <span class="toolbar-label">PUESTA A TIERRA:</span>
            <button class="btn-tool" onclick="selectTool('jabalina')" title="Jabalina de tierra">üî© Jabalina</button>
            <button class="btn-tool" onclick="selectTool('conductor-tierra')" title="Conductor protecci√≥n">‚ö° Conductor PE</button>
            <button class="btn-tool" onclick="selectTool('tierra-enchufe')" title="S√≠mbolo tierra">üåç Tierra</button>
        </div>

        <div class="toolbar-section section-entre-niveles">
            <span class="toolbar-label">CONEXI√ìN NIVELES:</span>
            <button class="btn-tool" onclick="selectTool('subida-nivel')" title="Punto de subida/bajada entre niveles">‚¨ÜÔ∏è Subida Nivel 2</button>
        </div>
        
        <div class="toolbar-section section-dibujo">
            <span class="toolbar-label">HERRAMIENTAS DIBUJO:</span>
            <button class="btn-tool" onclick="selectTool('linea')" title="Dibujar l√≠nea recta">üìè L√≠nea</button>
            <button class="btn-tool" onclick="selectTool('polilinea')" title="Click m√∫ltiple, Click Derecho o Doble Click para finalizar">üìê Polil√≠nea</button>
            <button class="btn-tool" onclick="selectTool('circulo')" title="Dibujar c√≠rculo">‚≠ï C√≠rculo</button>
            <button class="btn-tool" onclick="selectTool('rectangulo')" title="Dibujar rect√°ngulo">‚ñ≠ Rect√°ngulo</button>
            <button class="btn-tool" onclick="selectTool('cuadrado')" title="Dibujar cuadrado">‚óªÔ∏è Cuadrado</button>
        </div>
        
        <div class="toolbar-section section-color">
            <span class="toolbar-label">COLOR:</span>
            <div class="color-selector-inline">
                <button class="color-btn active" onclick="selectColor('#000000')" style="background: #000000;" title="Negro"></button>
                <button class="color-btn" onclick="selectColor('#FF0000')" style="background: #FF0000;" title="Rojo"></button>
                <button class="color-btn" onclick="selectColor('#0000FF')" style="background: #0000FF;" title="Azul"></button>
                <button class="color-btn" onclick="selectColor('#00FF00')" style="background: #00FF00;" title="Verde"></button>
                <button class="color-btn" onclick="selectColor('#FFFF00')" style="background: #FFFF00;" title="Amarillo"></button>
                <button class="color-btn" onclick="selectColor('#FF00FF')" style="background: #FF00FF;" title="Magenta"></button>
                <button class="color-btn" onclick="selectColor('#00FFFF')" style="background: #00FFFF;" title="Cyan"></button>
                <button class="color-btn" onclick="selectColor('#FFA500')" style="background: #FFA500;" title="Naranja"></button>
            </div>
            <input type="color" id="customColorPicker" value="#000000" title="Color personalizado" style="width: 40px; height: 30px; cursor: pointer; border: 2px solid #555; border-radius: 4px;">
        </div>
        
        <div class="toolbar-section section-grosor">
            <span class="toolbar-label">GROSOR:</span>
            <input type="range" id="strokeWidthSlider" min="1" max="10" value="2" style="width: 100px;" title="Grosor de l√≠nea">
            <span id="strokeWidthValue" style="color: #fff; font-weight: bold; min-width: 30px;">2px</span>
        </div>
        
        <div class="toolbar-section section-acciones">
            <span class="toolbar-label">ACCIONES:</span>
            <button class="btn-tool" onclick="toggleDibujo()" style="background: #e91e63;">
                üé® DIBUJO LIBRE
            </button>
            <button class="btn-tool" id="btnEtiquetas" onclick="toggleEtiquetas()" style="background: #f59e0b;">
                üè∑Ô∏è ETIQUETAS
            </button>
            
            <button class="btn-tool" onclick="generarTrazadoAutomatico()" style="background: #e74c3c;" title="Generar trazado completo de iluminaci√≥n + enchufes">
                ‚ö° TRAZADO COMPLETO
            </button>
            
            <button class="btn-tool" onclick="generarTrazadoIluminacion()" style="background: #f39c12;" title="Generar trazado solo de iluminaci√≥n e interruptores">
                üí° TRAZADO ILUMINACI√ìN
            </button>
            
            <button class="btn-tool" onclick="generarTrazadoEnchufes()" style="background: #3498db;" title="Generar trazado solo de enchufes y electrodom√©sticos">
                üîå TRAZADO ENCHUFES
            </button>
            
            <button class="btn-tool" onclick="limpiarTrazado()" style="background: #95a5a6;" title="Limpiar trazado generado">
                üßπ LIMPIAR TRAZADO
            </button>
            
            <button class="btn-tool" onclick="generarCircuitos()" style="background: #10b981;" title="Generar circuitos autom√°ticos">‚ö° Circuitos Auto</button>
            <button class="btn-tool btn-danger" onclick="limpiarTodo()">üóëÔ∏è Limpiar</button>
        </div>
    </div>    
    
    <!-- √ÅREA DE TRABAJO -->
    <div class="main-container">
        <div class="work-area">
            <div class="canvas-title">ALGORITMO INTELIGENTE DE DISE√ëO EL√âCTRICO DOMICILIARIO</div>
            <div class="canvas-wrapper">
                <div id="pdfLoading" class="pdf-loading" style="display: none;">
                    <div class="spinner"></div>
                    Cargando PDF...
                </div>
                <div class="drawing-board format-a1" id="drawingBoard">
                    <svg id="plano" viewBox="0 0 841 594">
                        <defs>
                            <pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse">
                                <path d="M 20 0 L 0 0 0 20" fill="none" stroke="#e5e5e5" stroke-width="0.5"/>
                            </pattern>
                        </defs>
                        <rect width="100%" height="100%" fill="#ffffff" />
                        <rect width="100%" height="100%" fill="url(#grid)" />
                    </svg>
                </div>
            </div>
        </div>
        
        <div class="right-panel" id="buscadorPanel">
            <!-- BUSCADOR INTEGRADO -->
            <iframe src="buscador-electrico/buscador-index.html" frameborder="0" style="width: 100%; height: 100%; border: none;"></iframe>
        </div>
    </div>
    
    <input type="file" id="fileInput" accept=".pdf,.svg,.jpg,.png" style="display: none;">
    
    <div class="status" id="status">Listo para dise√±ar</div>

    <!-- MODAL CUADRO DE CARGAS ACTUALIZADO - NUEVO -->
    <div class="modal-cuadro-cargas modal-cuadro-cargas-act" id="modalCuadroCargasACT">
        <div class="ventana-cuadro-cargas ventana-cuadro-cargas-act" id="ventanaCuadroCargasACT">
            <div class="modal-cuadro-cargas-header" id="headerCuadroCargasACT">
                <div class="modal-cuadro-cargas-title modal-cuadro-cargas-act-title">
                    ‚ö° CUADRO DE CARGAS EL√âCTRICO ACTUALIZADO
                </div>
                <div class="modal-cuadro-cargas-buttons">
                    <button class="btn-modal-cuadro-cargas close" onclick="cerrarCuadroCargasACT()">‚úï CERRAR</button>
                </div>
            </div>
            <div class="modal-cuadro-cargas-content">
                <iframe id="iframeCuadroCargasACT" frameborder="0"></iframe>
            </div>
        </div>
    </div>

    <!-- MODAL SIMBOLOG√çA -->
    <div class="modal" id="modalSimbologia">
        <div class="modal-window modal-large">
            <div class="modal-header">
                <div class="modal-title">üìä SIMBOLOG√çA EL√âCTRICA NORMALIZADA</div>
                <button class="btn-close" onclick="cerrarModal('modalSimbologia')">‚úï</button>
            </div>
            <div class="simbologia-actions">
                <button class="btn-integrar" onclick="integrarSimbologiaAlPlano()">
                    ‚ú® INTEGRAR EN PLANO
                </button>
                <div class="simbologia-info">
                    Coloca la tabla en el plano (arrastrable y redimensionable)
                </div>
            </div>
            <div class="modal-content">
                <div class="simbologia-grid">
                    <div class="simbolo-card">
                        <div class="simbolo-icon">üí°</div>
                        <div class="simbolo-name">Luminaria Cielo</div>
                        <div class="simbolo-desc">Punto de luz en techo</div>
                    </div>
                    <div class="simbolo-card">
                        <div class="simbolo-icon">üîå</div>
                        <div class="simbolo-name">Enchufe Simple</div>
                        <div class="simbolo-desc">10A - 220V</div>
                    </div>
                    <div class="simbolo-card">
                        <div class="simbolo-icon">üîò</div>
                        <div class="simbolo-name">Interruptor</div>
                        <div class="simbolo-desc">Simple / Doble</div>
                    </div>
                    <div class="simbolo-card">
                        <div class="simbolo-icon">‚ö°</div>
                        <div class="simbolo-name">Tablero</div>
                        <div class="simbolo-desc">Tablero El√©ctrico</div>
                    </div>
                    <div class="simbolo-card">
                        <div class="simbolo-icon">üåç</div>
                        <div class="simbolo-name">Tierra</div>
                        <div class="simbolo-desc">Puesta a tierra</div>
                    </div>
                    <div class="simbolo-card">
                        <div class="simbolo-icon">üì¶</div>
                        <div class="simbolo-name">Caja Derivaci√≥n</div>
                        <div class="simbolo-desc">Punto de conexi√≥n</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL TABLERO EL√âCTRICO INTERACTIVO -->
    <div class="modal" id="modalTableroInteractivo">
        <div class="modal-window">
            <div class="modal-header">
                <div class="modal-title">‚ö° TABLERO EL√âCTRICO INTERACTIVO - SINCRONIZADO CON PLANO</div>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <button class="btn-header" style="background: #27ae60; padding: 8px 16px; font-size: 13px;" onclick="integrarTableroAlPlano()">
                        üìå INTEGRAR TABLERO EN PLANO
                    </button>
                    <button class="btn-close" onclick="cerrarTablero()">‚úï</button>
                </div>
            </div>
            <div class="modal-content">
                <div class="tablero-container">
                    <!-- Medidor de energ√≠a -->
                    <div class="tablero-meter-section">
                        <div class="tablero-meter-header">MEDIDOR DE ENERG√çA - Sincronizado Autom√°ticamente</div>
                        <div class="tablero-meter-display">
                            <div class="tablero-meter-lcd">
                                <span id="tableroEnergyReading">00000.0</span>
                                <span class="meter-unit">kWh</span>
                            </div>
                        </div>
                        
                        <!-- Estad√≠sticas -->
                        <div class="tablero-stats-grid">
                            <div class="tablero-stat-card">
                                <div class="tablero-stat-label">Potencia Total</div>
                                <div class="tablero-stat-value" id="tableroPower">0<span class="stat-unit">W</span></div>
                            </div>
                            <div class="tablero-stat-card">
                                <div class="tablero-stat-label">Corriente Total</div>
                                <div class="tablero-stat-value" id="tableroCurrent">0.0<span class="stat-unit">A</span></div>
                            </div>
                            <div class="tablero-stat-card">
                                <div class="tablero-stat-label">Tensi√≥n Nominal</div>
                                <div class="tablero-stat-value">220<span class="stat-unit">V</span></div>
                            </div>
                            <div class="tablero-stat-card">
                                <div class="tablero-stat-label">Estado del Sistema</div>
                                <div class="tablero-stat-value status-ok" id="tableroStatus">NORMAL</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tablero-content">
                        <!-- Circuitos Primer Nivel -->
                        <div class="tablero-level-section">
                            <div class="tablero-level-title">
                                <span class="tablero-level-badge">1</span> Primer Nivel - Planta Baja
                            </div>
                            <div class="tablero-circuits-grid" id="tableroLevel1Grid">
                                <!-- Los circuitos se generan autom√°ticamente -->
                            </div>
                        </div>
                        
                        <!-- Circuitos Segundo Nivel -->
                        <div class="tablero-level-section">
                            <div class="tablero-level-title">
                                <span class="tablero-level-badge">2</span> Segundo Nivel - Planta Alta
                            </div>
                            <div class="tablero-circuits-grid" id="tableroLevel2Grid">
                                <!-- Los circuitos se generan autom√°ticamente -->
                            </div>
                        </div>
                        
                        <!-- Informaci√≥n de circuitos -->
                        <div class="tablero-info-section">
                            <h4>üè† Resumen Primer Nivel</h4>
                            <div id="tableroLevel1List">
                                <p class="empty-message">No hay circuitos en primer nivel</p>
                            </div>
                        </div>
                        
                        <div class="tablero-info-section">
                            <h4>üè† Resumen Segundo Nivel</h4>
                            <div id="tableroLevel2List">
                                <p class="empty-message">No hay circuitos en segundo nivel</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- POPUP SELECTOR DE NIVEL -->
    <div class="level-selector-popup" id="levelSelectorPopup">
        <div class="level-popup-header">
            <div class="level-popup-title">üè† Selecciona el Nivel</div>
            <div class="level-popup-subtitle">¬øEn qu√© nivel de la casa ir√° este elemento?</div>
        </div>
        
        <div class="level-buttons-container">
            <div class="level-btn level-1" onclick="selectLevel(1)">
                <div class="level-btn-badge">1</div>
                <div class="level-btn-title">Primer Nivel</div>
                <div class="level-btn-desc">Planta Baja</div>
            </div>
            
            <div class="level-btn level-2" onclick="selectLevel(2)">
                <div class="level-btn-badge">2</div>
                <div class="level-btn-title">Segundo Nivel</div>
                <div class="level-btn-desc">Planta Alta</div>
            </div>
        </div>
        
        <div class="level-popup-footer">
            <button class="level-cancel-btn" onclick="cancelLevelSelection()">Cancelar</button>
        </div>
    </div>

    <!-- MODAL SELECTOR DE TIPO DE TABLERO -->
    <div id="tableroTypeModal" style="display: none;">
        <div style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 40px; border-radius: 20px; box-shadow: 0 0 50px rgba(0,0,0,0.5); z-index: 1000000; min-width: 500px;">
            
            <h2 style="text-align: center; color: #2c3e50; margin: 0 0 10px 0; font-size: 28px;">‚ö° Selecciona el Tipo de Tablero</h2>
            <p style="text-align: center; color: #7f8c8d; margin: 0 0 30px 0; font-size: 16px;">¬øEste tablero ser√° para iluminaci√≥n o enchufes?</p>
            
            <div style="display: flex; gap: 20px; margin-bottom: 20px;">
                <button onclick="selectTableroType('iluminacion')" style="flex: 1; background: linear-gradient(135deg, #f39c12, #f1c40f); color: white; border: none; padding: 30px 20px; border-radius: 15px; cursor: pointer; font-size: 18px; font-weight: bold; transition: transform 0.2s;">
                    <div style="font-size: 40px; margin-bottom: 10px;">üí°</div>
                    <div>ILUMINACI√ìN</div>
                    <div style="font-size: 14px; font-weight: normal; margin-top: 5px;">Luces e Interruptores</div>
                </button>
                
                <button onclick="selectTableroType('enchufes')" style="flex: 1; background: linear-gradient(135deg, #3498db, #2980b9); color: white; border: none; padding: 30px 20px; border-radius: 15px; cursor: pointer; font-size: 18px; font-weight: bold; transition: transform 0.2s;">
                    <div style="font-size: 40px; margin-bottom: 10px;">üîå</div>
                    <div>ENCHUFES</div>
                    <div style="font-size: 14px; font-weight: normal; margin-top: 5px;">Enchufes y Electrodom√©sticos</div>
                </button>
            </div>
            
            <div style="text-align: center;">
                <button onclick="cancelTableroTypeSelection()" style="background: #95a5a6; color: white; border: none; padding: 12px 40px; border-radius: 8px; font-size: 16px; cursor: pointer;">Cancelar</button>
            </div>
            
        </div>
        <div onclick="cancelTableroTypeSelection()" style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.8); z-index: 999999;"></div>
    </div>

    <!-- M√ìDULOS DE JAVASCRIPT EXISTENTES -->
    <script src="level-selector.js"></script>
    <script src="javascript/tablero-type-modal.js"></script>
    <script src="tablero-integration.js"></script>
    <script src="javascript/app-state.js"></script>
    <script src="javascript/electric-symbols.js"></script>
    <script src="javascript/utilities.js"></script>
    <script src="javascript/resize-indicator.js"></script>
    <script src="javascript/image-controller.js"></script>
    <script src="javascript/image-resize-manager.js"></script>
    <script src="javascript/plano-loader.js"></script>
    <script src="javascript/zoom-pan.js"></script>
    
    <!-- HERRAMIENTAS DE DIBUJO GEOM√âTRICO -->
    <script src="javascript/drawing-tools.js"></script>
    <script src="javascript/drawing-controls.js"></script>
    
    <!-- SISTEMA DE TRAZADO AUTOM√ÅTICO -->
    <script src="trazado-automatico/config-tracer.js"></script>
    <script src="trazado-automatico/hierarchy-detector.js"></script>
    <script src="trazado-automatico/path-optimizer.js"></script>
    <script src="trazado-automatico/line-renderer.js"></script>
    <script src="trazado-automatico/main-tracer.js"></script>
    
    <script src="javascript/tools-manager.js"></script>
    <script src="javascript/canvas-handler.js"></script>
    <script src="javascript/labels-manager.js"></script>
    <script src="zoom-monitor.js"></script>
    <script src="javascript/mode-manager.js"></script>
    <script src="javascript/file-manager.js"></script>
    <script src="javascript/circuit-generator.js"></script>
    <script src="javascript/cuadro-cargas-sync.js"></script>
    
    <!-- SISTEMA DE INTEGRACI√ìN CUADRO DE CARGAS -->
    <script src="cuadro-cargas-integracion/cuadroCargasCore.js"></script>
    <script src="cuadro-cargas-integracion/cuadroCargasUI.js"></script>
    <script src="cuadro-cargas-integracion/cuadroCargasArrastre.js"></script>
    <script src="cuadro-cargas-integracion/cuadroCargasTabla.js"></script>
    <script src="cuadro-cargas-integracion/cuadroCargasIntegracion.js"></script>
    <script src="cuadro-cargas-integracion/cuadroCargasIndex.js"></script>
    
    <!-- SISTEMA DE INTEGRACI√ìN TABLERO EL√âCTRICO -->
    <script src="tablero-integracion/tableroIntegracionCore.js"></script>
    <script src="tablero-integracion/tableroIntegracionUI.js"></script>
    <script src="tablero-integracion/tableroIntegracionIndex.js"></script>
    
    <!-- SISTEMA DE ESQUEMA UNIFILAR -->
    <script src="esquema-unifilar/unifilarCore.js"></script>
    <script src="esquema-unifilar/unifilarCalculos.js"></script>
    <script src="esquema-unifilar/unifilarDibujo.js"></script>
    <script src="esquema-unifilar/unifilarIntegracion.js"></script>
    <script src="esquema-unifilar/unifilarIndex.js"></script>
    
    <script src="javascript/modals-manager.js"></script>
    <script src="javascript/export-manager.js"></script>
    <script src="javascript/cleanup-manager.js"></script>
    <script src="javascript/keyboard-handler.js"></script>
    <script src="javascript/initialization.js"></script>
    <script src="javascript/main.js"></script>

    <!-- GESTOR DE VI√ëETA EL√âCTRICA -->
    <script src="vi√±eta-electrica/vineta-handler.js"></script>

    <!-- Sistema Isom√©trico 3D Real -->
    <script src="isometrico-electrico/isometrico-math.js"></script>
    <script src="isometrico-electrico/isometrico-config.js"></script>
    <script src="isometrico-electrico/isometrico-converter.js"></script>
    <script src="isometrico-electrico/isometrico-renderer.js"></script>
    <script src="isometrico-electrico/isometrico-generator.js"></script>    
    <script src="isometrico-electrico/isometrico-zoom.js"></script>
    <script src="isometrico-electrico/isometrico-ui.js"></script>
    <script src="isometrico-electrico/isometrico-integracion.js"></script>

    <!-- SISTEMA DE SIMBOLOG√çA EL√âCTRICA INTEGRABLE -->
    <script src="simbologia-electrica/simbologiaElectricaCore.js"></script>
    <script src="simbologia-electrica/simbologiaElectricaUI.js"></script>
    <script src="simbologia-electrica/simbologiaElectricaArrastre.js"></script>
    <script src="simbologia-electrica/simbologiaElectricaTabla.js"></script>
    <script src="simbologia-electrica/simbologiaElectricaIntegracion.js"></script>
    <script src="simbologia-electrica/simbologiaElectricaIndex.js"></script>

    <!-- SISTEMA DE PREGUNTAS Y RESPUESTAS -->
    <script src="preguntas-respuestas/index.js"></script>
    <script src="preguntas-respuestas/01_normativa_general.js"></script>
    <script src="preguntas-respuestas/02_tableros_protecciones.js"></script>
    <script src="preguntas-respuestas/03_conductores_canalizaciones.js"></script>
    <script src="preguntas-respuestas/04_tipos_conductores_capacidades.js"></script>
    <script src="preguntas-respuestas/05_sistemas_canalizacion.js"></script>
    <script src="preguntas-respuestas/06_cajas_bandejas_canalizaciones.js"></script>
    <script src="preguntas-respuestas/07_proteccion_tensiones_peligrosas.js"></script>
    <script src="preguntas-respuestas/08_puestas_a_tierra.js"></script>
    <script src="preguntas-respuestas/09_instalaciones_alumbrado.js"></script>
    <script src="preguntas-respuestas/10_instalaciones_fuerza.js"></script>

    <!-- ASISTENTE VIRTUAL EL√âCTRICO -->
    <script src="asistente-virtual/asistenteKnowledge.js"></script>
    <script src="asistente-virtual/asistenteCore.js"></script>
    <script src="asistente-virtual/asistenteUI.js"></script>
    <script src="asistente-virtual/asistenteIndex.js"></script>
           
    <!-- SCRIPTS DE INTEGRACI√ìN - MEMORIA Y EETT -->
    <script src="memoria-electrica/modal-integration.js"></script>
    <script src="especificaciones-tecnicas/modal-integration.js"></script>

    <!-- EXPORTADOR PDF -->
    <script src="exportar-pdf/exportador-configuracion.js"></script>
    <script src="exportar-pdf/exportador-core.js"></script>
    <script src="exportar-pdf/exportador-ui.js"></script>

    <!-- SISTEMA DE PLANOS EL√âCTRICOS M√öLTIPLES -->
    <script src="sistema-planos-electricos/electrico-plano-instance.js"></script>
    <script src="sistema-planos-electricos/electrico-plano-state.js"></script>
    <script src="sistema-planos-electricos/electrico-plano-state-manager.js"></script>
    <script src="sistema-planos-electricos/electrico-plano-manager.js"></script>
    <script src="sistema-planos-electricos/electrico-plano-ui.js"></script>
    <script src="sistema-planos-electricos/vineta-interceptor.js"></script>
    <script src="sistema-planos-electricos/cuadro-cargas-interceptor.js"></script>
    <script src="sistema-planos-electricos/electrico-plano-integration.js"></script>
    
    <!-- üìù SISTEMA DE TEXTO PERSONALIZADO -->
    <script src="sistema-texto-plano/texto-config.js"></script>
    <script src="sistema-texto-plano/texto-core.js"></script>
    <script src="sistema-texto-plano/texto-ui.js"></script>
    <script src="sistema-texto-plano/texto-integration.js"></script>
    
    <!-- INICIALIZACI√ìN DEL SISTEMA COMPLETO -->
    <script>
        // Inicializar sistema de integraci√≥n cuando cargue la p√°gina
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Iniciando sistema ELEKTRA...');
            
            // INICIALIZAR TABLERO EL√âCTRICO
            if (typeof initTableroIntegration === 'function') {
                initTableroIntegration();
                console.log('‚úÖ Sistema de tablero integrado inicializado');
            }
            
            // INICIALIZAR CUADRO DE CARGAS
            if (typeof initCuadroCargas === 'function') {
                initCuadroCargas();
                console.log('‚úÖ Sistema de Cuadro de Cargas inicializado');
            }
            
            // INICIALIZAR SISTEMA DE PREGUNTAS Y RESPUESTAS
            console.log('üìö Cargando base de conocimientos...');
            
            if (typeof cargarArchivoPR !== 'function') {
                console.error('‚ùå Error: No se encontr√≥ la funci√≥n cargarArchivoPR()');
                console.error('‚ùå Verifica que el archivo preguntas-respuestas/index.js est√© cargado correctamente');
                return;
            }
            
            const archivos = [
                { nombre: '01 - Normativa General', variable: preguntasRespuestas_01 },
                { nombre: '02 - Tableros y Protecciones', variable: preguntasRespuestas_02 },
                { nombre: '03 - Conductores y Canalizaciones', variable: preguntasRespuestas_03 },
                { nombre: '04 - Tipos de Conductores', variable: preguntasRespuestas_04 },
                { nombre: '05 - Sistemas de Canalizaci√≥n', variable: preguntasRespuestas_05 },
                { nombre: '06 - Cajas y Bandejas', variable: preguntasRespuestas_06 },
                { nombre: '07 - Protecci√≥n Tensiones Peligrosas', variable: preguntasRespuestas_07 },
                { nombre: '08 - Puestas a Tierra', variable: preguntasRespuestas_08 },
                { nombre: '09 - Instalaciones de Alumbrado', variable: preguntasRespuestas_09 },
                { nombre: '10 - Instalaciones de Fuerza', variable: preguntasRespuestas_10 }
            ];
            
            let archivosExitosos = 0;
            let archivosFallidos = 0;
            
            archivos.forEach((archivo, index) => {
                if (typeof archivo.variable !== 'undefined') {
                    try {
                        cargarArchivoPR(archivo.variable);
                        archivosExitosos++;
                        console.log(`‚úÖ Archivo ${String(index + 1).padStart(2, '0')} - ${archivo.nombre} cargado`);
                    } catch (error) {
                        archivosFallidos++;
                        console.error(`‚ùå Error al cargar archivo ${String(index + 1).padStart(2, '0')}:`, error);
                    }
                } else {
                    archivosFallidos++;
                    console.warn(`‚ö†Ô∏è Archivo ${String(index + 1).padStart(2, '0')} - ${archivo.nombre} no encontrado`);
                }
            });
            
            console.log('\n' + '='.repeat(60));
            console.log(`üìä RESUMEN DE CARGA DE BASE DE CONOCIMIENTOS`);
            console.log('='.repeat(60));
            console.log(`‚úÖ Archivos cargados exitosamente: ${archivosExitosos}/10`);
            if (archivosFallidos > 0) {
                console.log(`‚ùå Archivos con error: ${archivosFallidos}/10`);
            }
            
            if (typeof obtenerEstadisticasPR === 'function') {
                const stats = obtenerEstadisticasPR();
                console.log(`üìö Total de preguntas cargadas: ${stats.total_preguntas}`);
                console.log(`üè∑Ô∏è Categor√≠as disponibles: ${stats.categorias_cargadas}`);
                if (stats.categorias_disponibles && Array.isArray(stats.categorias_disponibles)) {
                    console.log(`üìÇ Categor√≠as: ${stats.categorias_disponibles.join(', ')}`);
                }
                console.log('='.repeat(60) + '\n');
                
                if (stats.total_preguntas === 0) {
                    console.error('‚ùå ADVERTENCIA: No se cargaron preguntas. Verifica los archivos JS.');
                } else {
                    console.log(`‚úÖ Sistema de asistente virtual listo con ${stats.total_preguntas} preguntas`);
                }
            }
            
            console.log('‚úÖ Sistema de Modal Memoria El√©ctrica integrado');
            console.log('‚úÖ Sistema de Modal Especificaciones T√©cnicas integrado');
            
            // INICIALIZAR HERRAMIENTAS DE DIBUJO
            if (typeof initializeDrawingControls === 'function') {
                initializeDrawingControls();
                console.log('‚úÖ Controles de color y grosor inicializados');
            }
            
            const plano = document.getElementById('plano');
            if (plano) {
                plano.addEventListener('mousemove', handleCanvasMouseMove);
                plano.addEventListener('dblclick', handleCanvasDoubleClick);
                console.log('‚úÖ Eventos de dibujo configurados en canvas');
            }
            
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Delete' || e.key === 'Backspace') {
                    if (typeof deleteSelectedDrawing === 'function') {
                        deleteSelectedDrawing();
                    }
                }
                if (e.key === 'Escape') {
                    if (AppState.currentTool === 'polilinea' && AppState.polylinePoints.length > 0) {
                        AppState.polylinePoints = [];
                        if (AppState.tempDrawingElement) {
                            AppState.tempDrawingElement.remove();
                            AppState.tempDrawingElement = null;
                        }
                        updateStatus('‚ùå Polil√≠nea cancelada');
                    }
                }
            });
            console.log('‚úÖ Teclas DELETE y ESC configuradas');
            console.log('‚úÖ Sistema de Herramientas de Dibujo integrado');
            
            // INICIALIZAR SISTEMA DE TEXTO
            console.log('‚úÖ Sistema de Texto Personalizado integrado');
            
            console.log('\nüéâ Sistema ELEKTRA completamente inicializado\n');
        });
    </script>
</body>
</html>